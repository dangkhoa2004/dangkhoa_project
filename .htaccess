# ----------------------------------------------------------------------
# 1. CẤU HÌNH CƠ BẢN & BẢO MẬT
# ----------------------------------------------------------------------
# Tắt tính năng liệt kê danh sách file trong thư mục (tránh lộ dữ liệu)
Options -Indexes

# Bật bộ máy ghi lại đường dẫn
RewriteEngine On

# Chặn truy cập trực tiếp vào các file nhạy cảm và file cấu hình
# Bao gồm: .htaccess, .git, config.php, db.php, các file markdown
<FilesMatch "^(\.htaccess|\.htpasswd|\.git|config\.php|db\.php|README\.md)">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# ----------------------------------------------------------------------
# 2. ĐỊNH TUYẾN (ROUTING) - QUAN TRỌNG NHẤT
# ----------------------------------------------------------------------
# Kiểm tra: Nếu đường dẫn KHÔNG phải là một file thực tế đang tồn tại
RewriteCond %{REQUEST_FILENAME} !-f

# Kiểm tra: Nếu đường dẫn KHÔNG phải là một thư mục thực tế đang tồn tại
RewriteCond %{REQUEST_FILENAME} !-d

# Thì chuyển hướng mọi yêu cầu về file index.php để xử lý
RewriteRule ^(.*)$ index.php [QSA,L]